import{r as h,_ as te,R as L,a as R,c as ne,P as v,d as le,B as ce,j as s}from"./index-C6UZZE1B.js";import{e as ae,b as de,c as Q,d as W}from"./CRow-BOoGTJLM.js";import{a as g,c as V,d as ue}from"./index.esm-CaOeY0Rr.js";import{C as me}from"./CConditionalPortal-BWtFwqv2.js";import{i as ee,b as pe}from"./DefaultLayout-LzP_z8e3.js";import{u as fe}from"./CCloseButton-B3bq1kyM.js";import{h as oe}from"./database-CL0enfGk.js";import{C as X,a as S,c as _,d as K}from"./CModalTitle-DyJ8safq.js";var re=h.forwardRef(function(e,d){var i=e.children,m=e.className,f=e.feedback,p=e.feedbackInvalid,b=e.feedbackValid,A=e.floatingClassName,y=e.floatingLabel,w=e.id,C=e.invalid,O=e.label,D=e.plainText,P=e.text,T=e.tooltipFeedback,x=e.valid,N=te(e,["children","className","feedback","feedbackInvalid","feedbackValid","floatingClassName","floatingLabel","id","invalid","label","plainText","text","tooltipFeedback","valid"]);return L.createElement(ae,{describedby:N["aria-describedby"],feedback:f,feedbackInvalid:p,feedbackValid:b,floatingClassName:A,floatingLabel:y,id:w,invalid:C,label:O,text:P,tooltipFeedback:T,valid:x},L.createElement("textarea",R({className:ne(D?"form-control-plaintext":"form-control",{"is-invalid":C,"is-valid":x},m),id:w},N,{ref:d}),i))});re.propTypes=R({className:v.string,id:v.string,plainText:v.bool},ae.propTypes);re.displayName="CFormTextarea";var ve=function(e){if(!e)return 0;var d=window.getComputedStyle(e),i=d.transitionDuration,m=d.transitionDelay,f=Number.parseFloat(i),p=Number.parseFloat(m);return!f&&!p?0:(i=i.split(",")[0],m=m.split(",")[0],(Number.parseFloat(i)+Number.parseFloat(m))*1e3)},se=function(e){typeof e=="function"&&e()},he=function(e){e.dispatchEvent(new Event("transitionend"))},xe=function(e,d,i){if(i===void 0&&(i=!0),!i){se(e);return}var m=5,f=ve(d)+m,p=!1,b=function(A){var y=A.target;y===d&&(p=!0,d.removeEventListener("transitionend",b),se(e))};d.addEventListener("transitionend",b),setTimeout(function(){p||he(d)},f)},be=function(e,d){switch(e){case"right":return ee(d)?"left":"right";case"left":return ee(d)?"right":"left";default:return e}},Z=h.forwardRef(function(e,d){var i=e.children,m=e.animation,f=m===void 0?!0:m,p=e.className,b=e.container,A=e.content,y=e.delay,w=y===void 0?0:y,C=e.fallbackPlacements,O=C===void 0?["top","right","bottom","left"]:C,D=e.offset,P=D===void 0?[0,6]:D,T=e.onHide,x=e.onShow,N=e.placement,I=N===void 0?"top":N,$=e.trigger,j=$===void 0?["hover","focus"]:$,E=e.visible,q=te(e,["children","animation","className","container","content","delay","fallbackPlacements","offset","onHide","onShow","placement","trigger","visible"]),k=h.useRef(null),F=h.useRef(null),z=fe(d,k),B="tooltip".concat(h.useId()),t=h.useState(!1),a=t[0],n=t[1],o=h.useState(E),l=o[0],r=o[1],u=pe(),c=u.initPopper,M=u.destroyPopper,H=u.updatePopper,G=typeof w=="number"?{show:w,hide:w}:w,ie={modifiers:[{name:"arrow",options:{element:".tooltip-arrow"}},{name:"flip",options:{fallbackPlacements:O}},{name:"offset",options:{offset:P}}],placement:be(I,F.current)};h.useEffect(function(){if(E){Y();return}J()},[E]),h.useEffect(function(){if(a&&F.current&&k.current){c(F.current,k.current,ie),setTimeout(function(){r(!0)},G.show);return}!a&&F.current&&k.current&&M()},[a]),h.useEffect(function(){!l&&F.current&&k.current&&xe(function(){n(!1)},k.current)},[l]);var Y=function(){n(!0),x&&x()},J=function(){setTimeout(function(){r(!1),T&&T()},G.hide)};return h.useEffect(function(){H()},[A]),L.createElement(L.Fragment,null,L.cloneElement(i,R(R(R(R(R({},l&&{"aria-describedby":B}),{ref:F}),(j==="click"||j.includes("click"))&&{onClick:function(){return l?J():Y()}}),(j==="focus"||j.includes("focus"))&&{onFocus:function(){return Y()},onBlur:function(){return J()}}),(j==="hover"||j.includes("hover"))&&{onMouseEnter:function(){return Y()},onMouseLeave:function(){return J()}})),L.createElement(me,{container:b,portal:!0},a&&L.createElement("div",R({className:ne("tooltip","bs-tooltip-auto",{fade:f,show:l},p),id:B,ref:z,role:"tooltip"},q),L.createElement("div",{className:"tooltip-arrow"}),L.createElement("div",{className:"tooltip-inner"},A))))});Z.propTypes={animation:v.bool,children:v.node,container:v.any,content:v.oneOfType([v.string,v.node]),delay:v.oneOfType([v.number,v.shape({show:v.number.isRequired,hide:v.number.isRequired})]),fallbackPlacements:ce,offset:v.any,onHide:v.func,onShow:v.func,placement:v.oneOf(["auto","top","right","bottom","left"]),trigger:le,visible:v.bool};Z.displayName="CTooltip";var ge=["512 512","<polygon fill='var(--ci-primary-color, currentColor)' points='367.997 338.75 271.999 434.747 271.999 17.503 239.999 17.503 239.999 434.745 144.003 338.75 121.376 361.377 256 496 390.624 361.377 367.997 338.75' class='ci-primary'/>"],Ae=["512 512","<polygon fill='var(--ci-primary-color, currentColor)' points='390.624 150.625 256 16 121.376 150.625 144.004 173.252 240.001 77.254 240.001 495.236 272.001 495.236 272.001 77.257 367.996 173.252 390.624 150.625' class='ci-primary'/>"],we=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M472,472H40a24.028,24.028,0,0,1-24-24V64A24.028,24.028,0,0,1,40,40H226.667a23.935,23.935,0,0,1,22.154,14.77L269.333,104H472a24.028,24.028,0,0,1,24,24V448A24.028,24.028,0,0,1,472,472ZM48,440H464V136H248L221.333,72H48Z' class='ci-primary'/>"],Ce=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M29.663,482.25l.087.087a24.847,24.847,0,0,0,17.612,7.342,25.178,25.178,0,0,0,8.1-1.345l142.006-48.172,272.5-272.5A88.832,88.832,0,0,0,344.334,42.039l-272.5,272.5L23.666,456.541A24.844,24.844,0,0,0,29.663,482.25Zm337.3-417.584a56.832,56.832,0,0,1,80.371,80.373L411.5,180.873,331.127,100.5ZM99.744,331.884,308.5,123.127,388.873,203.5,180.116,412.256,58.482,453.518Z' class='ci-primary'/>"],je=["512 512","<polygon fill='var(--ci-primary-color, currentColor)' points='440 240 272 240 272 72 240 72 240 240 72 240 72 272 240 272 240 440 272 440 272 272 440 272 440 240' class='ci-primary'/>"];const Pe={firstName:"",lastName:"",companyName:"",address:"",province:"",state:"",street:"",city:"",zip:"",country:"US",dob:null,phoneNumber:"",firstDepositDate:null,beneficiaries:[],connectedUsers:[],cid:"",uid:"",appEmail:"",initEmail:"",totalAssets:0,ytd:0,totalYTD:0,linked:!1,assets:{armm:{personal:{amount:0,firstDepositDate:new Date,displayTitle:"Personal",index:0}}}},Re={amount:0,fund:"ARMM",recipient:"",time:new Date,type:"profit",isDividend:!1,sendNotif:!0,isAmortization:!1,notes:void 0,parentName:""},ye=({title:e,id:d,fundKey:i,assetType:m,disabled:f=!1,clientState:p,setClientState:b,incrementAmount:A,onRemove:y,onEdit:w,isEditable:C,onMoveUp:O,onMoveDown:D,isFirst:P,isLast:T})=>{var a;const x=((a=p.assets[i])==null?void 0:a[m])??{amount:0,firstDepositDate:null,displayTitle:e,index:0},[N,I]=h.useState(!1),[$,j]=h.useState(e),E=n=>{const o=n.target.value;if(/^\d*\.?\d{0,2}$/.test(o)){const l=parseFloat(o),r={...p,assets:{...p.assets,[i]:{...p.assets[i],[m]:{...x,amount:l}}}};b(r)}},q=n=>{const o=n.target.value;if(o===""||isNaN(parseFloat(o))){const l={...p,assets:{...p.assets,[i]:{...p.assets[i],[m]:{...x,amount:0}}}};b(l)}},k=n=>{const o=n.target.value?new Date(n.target.value):null,l={...p,assets:{...p.assets,[i]:{...p.assets[i],[m]:{...x,firstDepositDate:o}}}};b(l)},F=()=>{j(e),I(!0)},z=()=>{I(!1),j(e)},B=()=>{const n=$.trim();if(n===""){alert("Asset name cannot be empty.");return}w(i,m,n),I(!1)},t=()=>{y(i,m)};return s.jsxs(s.Fragment,{children:[s.jsxs(de,{className:"mb-3 pb-3",children:[s.jsx(Q,{style:{width:"200px"},children:x.displayTitle}),s.jsx(Q,{children:"$"}),s.jsx(W,{id:d,disabled:f,type:"number",step:A,value:x.amount,onChange:E,onBlur:q}),s.jsx(Q,{style:{width:"200px"},children:"First Deposit Date"}),s.jsx(W,{type:"date",disabled:f,value:x.firstDepositDate?x.firstDepositDate.toISOString().substring(0,10):"",onChange:k}),C&&s.jsxs(s.Fragment,{children:[s.jsx(Z,{content:"Edit Asset Name",placement:"top",children:s.jsx(g,{variant:"outline",className:"ms-2 p-0 border-0",onClick:F,"aria-label":`Edit ${e}`,disabled:f,children:s.jsx(V,{icon:Ce,size:"lg"})})}),s.jsx(Z,{content:`Remove ${e} as an Asset`,placement:"top",children:s.jsx(g,{variant:"ghost",className:"ms-2 p-0 border-0",onClick:t,"aria-label":`Remove ${e}`,disabled:f,children:s.jsx(V,{icon:oe,size:"lg"})})}),s.jsx(Z,{content:"Move Up",placement:"top",children:s.jsx(g,{variant:"outline",className:"ms-2 p-0 border-0",onClick:()=>O(i,m),"aria-label":`Move ${e} Up`,disabled:f||P,children:s.jsx(V,{icon:Ae,size:"lg"})})}),s.jsx(Z,{content:"Move Down",placement:"top",children:s.jsx(g,{variant:"outline",className:"ms-2 p-0 border-0",onClick:()=>D(i,m),"aria-label":`Move ${e} Down`,disabled:f||T,children:s.jsx(V,{icon:ge,size:"lg"})})})]})]}),C&&s.jsxs(X,{visible:N,onClose:z,alignment:"center",backdrop:"static",children:[s.jsx(S,{children:"Edit Asset"}),s.jsx(_,{children:s.jsx(W,{label:"Asset Name",placeholder:"Enter new asset name",value:$,onChange:n=>j(n.target.value),disabled:f})}),s.jsxs(K,{children:[s.jsx(g,{color:"secondary",onClick:z,disabled:f,children:"Cancel"}),s.jsx(g,{color:"primary",onClick:B,disabled:f,children:"Save"})]})]})]})},U=["total","fund"],Oe=({clientState:e,setClientState:d,activeFund:i,incrementAmount:m=1e4,viewOnly:f=!1})=>{const[p,b]=h.useState(!1),[A,y]=h.useState(null),[w,C]=h.useState(""),[O,D]=h.useState(!1),[P,T]=h.useState(""),x=()=>{T(""),D(!0)},N=()=>{D(!1),T("")},I=()=>{const t=P.trim();if(!t){alert("Fund name cannot be empty.");return}const a=t.toLowerCase().replace(/\s+/g,"-");if(e.assets[a]){alert("A fund with this name already exists.");return}const n={...e,assets:{...e.assets,[a]:{}}};d(n),N()},$=t=>{if(!window.confirm(`Are you sure you want to delete the fund "${t}" and all its assets?`))return;const a={...e.assets};delete a[t];const n={...e,assets:a};d(n)},j=t=>{y(t),C(""),b(!0)},E=()=>{b(!1),y(null),C("")},q=()=>{if(!A)return;const t=w.trim();if(t===""){alert("Asset name cannot be empty.");return}if(U.includes(t.toLowerCase())){alert("The asset name 'total' or 'fund' is reserved and cannot be used.");return}const n=t.toLowerCase().replace(/\s+/g,"-"),o=e.assets[A]||{};if(Object.values(o).some(c=>c.displayTitle.toLowerCase()===t.toLowerCase())){alert("An asset with this name already exists.");return}const r=Math.max(-1,...Object.values(o).filter(c=>!U.includes(c.displayTitle.toLowerCase())).map(c=>c.index??0)),u={...e,assets:{...e.assets,[A]:{...o,[n]:{amount:0,firstDepositDate:new Date,displayTitle:t,index:r+1}}}};d(u),E()},k=(t,a)=>{if(U.includes(a.toLowerCase())){alert("This asset cannot be removed.");return}if(!window.confirm(`Are you sure you want to remove the asset "${a}"?`))return;const n={...e.assets[t]};delete n[a];const o=Object.entries(n).filter(([u])=>!U.includes(u.toLowerCase())).sort(([,u],[,c])=>(u.index??0)-(c.index??0)).map(([u,c],M)=>(c.index=M,[u,c])),l=Object.fromEntries(o),r={...e,assets:{...e.assets,[t]:l}};d(r)},F=(t,a,n)=>{const o=n.trim();if(o===""){alert("Asset name cannot be empty.");return}if(U.includes(o.toLowerCase())){alert("The asset name 'total' or 'fund' is reserved and cannot be used.");return}const l=e.assets[t];if(Object.values(l).some(G=>G.displayTitle.toLowerCase()===o.toLowerCase()&&a!==G.displayTitle.toLowerCase().replace(/\\s+/g,"-"))){alert("An asset with this name already exists in this fund.");return}const c={...l[a],displayTitle:o},M={...l,[a]:c},H={...e,assets:{...e.assets,[t]:M}};d(H)},z=(t,a)=>{const n={...e.assets[t]},o=Object.entries(n).filter(([r])=>!U.includes(r.toLowerCase())).sort(([,r],[,u])=>(r.index??0)-(u.index??0)),l=o.findIndex(([r])=>r===a);if(l>0){const r=o[l-1][0],u=n[a],c=n[r],M=u.index;u.index=c.index,c.index=M;const H={...e,assets:{...e.assets,[t]:{...n,[a]:u,[r]:c}}};d(H)}},B=(t,a)=>{const n={...e.assets[t]},o=Object.entries(n).filter(([r])=>!U.includes(r.toLowerCase())).sort(([,r],[,u])=>(r.index??0)-(u.index??0)),l=o.findIndex(([r])=>r===a);if(l<o.length-1){const r=o[l+1][0],u=n[a],c=n[r],M=u.index;u.index=c.index,c.index=M;const H={...e,assets:{...e.assets,[t]:{...n,[a]:u,[r]:c}}};d(H)}};return s.jsxs(ue,{className:"py-3",children:[Object.entries(e.assets).map(([t,a])=>s.jsxs("div",{className:"mb-5",children:[s.jsx("div",{className:"mb-2 pb-3",children:s.jsxs("h5",{children:[t.toUpperCase()," Fund Assets"]})}),Object.entries(a).filter(([n])=>!["total","fund"].includes(n.toLowerCase())).sort(([,n],[,o])=>(n.index??0)-(o.index??0)).map(([n,o],l)=>{const r=l===0,u=l===Object.keys(a).length-1;let c=f;return!c&&i!==void 0&&t.toUpperCase()!==i.toUpperCase()&&(c=!0),s.jsx(ye,{title:o.displayTitle,id:`${t}-${n}`,fundKey:t,assetType:n,clientState:e,setClientState:d,disabled:c,incrementAmount:m,onRemove:k,onEdit:F,onMoveUp:z,onMoveDown:B,isEditable:!c,isFirst:r,isLast:u},`${t}-${n}`)}),!f&&s.jsxs("div",{className:"mt-3 d-flex justify-content-between align-items-center",children:[s.jsx("div",{children:s.jsxs(g,{color:"primary",onClick:()=>j(t),children:[s.jsx(V,{icon:je,className:"me-1"}),"Add Asset"]})}),s.jsxs("div",{className:"d-flex gap-2",children:[s.jsxs(g,{color:"success",variant:"outline",onClick:x,children:[s.jsx(V,{icon:we,className:"me-1"}),"Add Fund"]}),s.jsxs(g,{color:"danger",variant:"outline",size:"sm",onClick:()=>$(t),children:[s.jsx(V,{icon:oe,className:"me-1"}),"Delete Fund"]})]})]})]},t)),s.jsxs(X,{visible:p,onClose:E,alignment:"center",children:[s.jsx(S,{children:"Add New Asset"}),s.jsx(_,{children:s.jsx(W,{label:"Asset Name",placeholder:"Enter asset name",value:w,onChange:t=>C(t.target.value.replace(/["']/g,""))})}),s.jsxs(K,{children:[s.jsx(g,{color:"secondary",onClick:E,children:"Cancel"}),s.jsx(g,{color:"primary",onClick:q,children:"Add"})]})]}),s.jsxs(X,{visible:O,onClose:N,alignment:"center",children:[s.jsx(S,{children:"Add New Fund"}),s.jsx(_,{children:s.jsx(W,{label:"Fund Name",placeholder:"Enter fund name",value:P,onChange:t=>T(t.target.value.replace(/["']/g,""))})}),s.jsxs(K,{children:[s.jsx(g,{color:"secondary",onClick:N,children:"Cancel"}),s.jsx(g,{color:"success",variant:"outline",onClick:I,children:"Add Fund"})]})]})]})};export{Z as C,Oe as E,re as a,Pe as b,je as c,Re as e};
